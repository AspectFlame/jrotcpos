<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="styles/theme.css">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
    <script src="https://twitter.github.io/typeahead.js/releases/latest/typeahead.bundle.js"></script>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col">
                <h2>All orders</h2>
            </div>
        </div>
        <div class="row" id="display_orders">
        </div>
    </div>
</body>
<script>
    orders = {};
     $.ajax({
        url: "http://localhost:5001/get_order_info",
        context: this,
        method: "get",
        dataType: "json"
    }).done(function (data, status) {
        items = data;
        for (item of items) {
            if (orders[item[0]]) {
                orders[item[0]].push(item)
            } else {
                orders[item[0]] = [item]
            }
        }
        for (let [key, value] of Object.entries(orders)) {
            $('#display_orders').append(generateCard(value));
        }
    });
    function generateCard(array) {
        cardsHtml = '<div class="col-4 mb-2">';
        cardsHtml += '<div class="card h-100">';
        cardsHtml += '<div class="card-header"><b>Customer email: </b>' + array[0][1] + '<br><b>Recipient Name and Email: </b>' + array[0][3] + ' ' + array[0][4] + ', ' + array[0][5] + '<br><b>Recipient Schedule: </b>' + array[0][6] + ', ' + array[0][7] + ', ' + array[0][8] + ', ' + array[0][9] + ', ' + array[0][10] + ', ' + array[0][11] + ', ' + array[0][12] + ', ' + array[0][13] +'</div>';
        cardsHtml += '<div class="card-body"><p class="mb-2">' + array[0][2] + '</p>';
        for (detail of array) {
            cardsHtml += '<p class="mb-0">' + detail[14] + ' x' + detail[15] + '</p>'; 
        }
        cardsHtml += '</div>';
        cardsHtml += '<div class="card-footer">';
        cardsHtml += '<div class="row">';
        cardsHtml += '<div class="col"><button type="button" class="btn btn-block btn-primary" onclick="">Confirm</button></div>'
        cardsHtml += '<div class="col"><button type="button" class="btn btn-block btn-danger" onclick="">Delete</button></div>'
        cardsHtml += '</div></div></div></div>';
        return cardsHtml;
    }
</script>
</html>